// Test Collect Operator - Plan 051 Phase 8
// Test collect() method and bang operator (!)

use auto.list: List

// Helper function for map
fn double(x int) int {
    x * 2
}

// Helper function for filter
fn is_gt_3(x int) bool {
    x > 3
}

fn main() {
    // Create a list
    let list = List.new()
    list.push(1)
    list.push(2)
    list.push(3)
    list.push(4)
    list.push(5)

    // Test 1: Collect with bang operator after map
    // Should create new list with doubled values
    let mapped = list.iter().map(double)!
    say(mapped.len())

    // Test 2: Collect with explicit method call after filter
    // Should create new list with only elements > 3
    let filtered = list.iter().filter(is_gt_3).collect()
    say(filtered.len())

    // Test 3: Collect after chaining map and filter
    // First double (1,2,3,4,5) -> (2,4,6,8,10)
    // Then filter > 3 -> (4,6,8,10)
    // Should have 4 elements
    let chained = list.iter().map(double).filter(is_gt_3).collect()
    say(chained.len())
}
