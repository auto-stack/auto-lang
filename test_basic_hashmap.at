/// Test HashMap OOP-style API
/// This demonstrates the new OOP approach with type declarations

fn test_hashmap_new() int {
    let map = HashMap.new()
    map.drop()
    0
}

fn test_hashmap_insert_str() int {
    let map = HashMap.new()
    map.insert_str("name", "Alice")
    map.insert_str("city", "Wonderland")

    let name = map.get_str("name")
    let city = map.get_str("city")
    map.drop()

    if name == "Alice" && city == "Wonderland" {
        1
    } else {
        0
    }
}

fn test_hashmap_insert_int() int {
    let map = HashMap.new()
    map.insert_int("count", 42)
    map.insert_int("age", 25)

    let count = map.get_int("count")
    let age = map.get_int("age")
    map.drop()

    if count == 42 && age == 25 {
        1
    } else {
        0
    }
}

fn test_hashmap_contains() int {
    let map = HashMap.new()
    map.insert_str("test", "data")

    let has_test = map.contains("test")
    let has_missing = map.contains("missing")
    map.drop()

    if has_test == 1 && has_missing == 0 {
        1
    } else {
        0
    }
}

fn test_hashmap_size() int {
    let map = HashMap.new()
    map.insert_str("a", "1")
    map.insert_str("b", "2")
    map.insert_str("c", "3")

    let size = map.size()
    map.drop()

    if size == 3 {
        1
    } else {
        0
    }
}

fn test_hashmap_remove() int {
    let map = HashMap.new()
    map.insert_str("temp", "data")

    // Remove should work
    map.remove("temp")

    // After removal, should not contain
    let has_after = map.contains("temp")
    map.drop()

    if has_after == 0 {
        1
    } else {
        0
    }
}

fn test_hashmap_clear() int {
    let map = HashMap.new()
    map.insert_str("a", "1")
    map.insert_str("b", "2")

    // Clear should remove all
    map.clear()

    let size = map.size()
    map.drop()

    if size == 0 {
        1
    } else {
        0
    }
}

fn main() {
    let r1 = test_hashmap_new()
    let r2 = test_hashmap_insert_str()
    let r3 = test_hashmap_insert_int()
    let r4 = test_hashmap_contains()
    let r5 = test_hashmap_size()
    let r6 = test_hashmap_remove()
    let r7 = test_hashmap_clear()

    // All tests should return 1
    r1 + r2 + r3 + r4 + r5 + r6 + r7
}
