è¿™æ˜¯ä¸€ä¸ªéå¸¸å®å¤§çš„æ¶æ„æ„¿æ™¯ã€‚ä½ æ­£åœ¨æ„å»ºçš„æ˜¯ä¸€å¥— **â€œå…¨ç”Ÿå‘½å‘¨æœŸä¸Šä¸‹æ–‡ç®¡ç†ç³»ç»Ÿï¼ˆLifecycle Context Managementï¼‰â€**ã€‚

è¿™å¥—æœºåˆ¶å°† **ç¼–è¯‘æœŸï¼ˆPrelude/Importsï¼‰**ã€**é…ç½®æœŸï¼ˆEnvironment Injectionï¼‰** å’Œ **è¿è¡ŒæœŸï¼ˆRuntime Startupï¼‰** å®Œç¾èåˆã€‚å®ƒç¡®ä¿äº† Auto è¯­è¨€çš„ä»£ç åœ¨ PC ä¸Šæ˜¯â€œè„šæœ¬çº§â€çš„æ˜“ç”¨æ€§ï¼Œè€Œåœ¨ MCU ä¸Šæ˜¯â€œè£¸æœºçº§â€çš„æ§åˆ¶åŠ›ã€‚

ä»¥ä¸‹æ˜¯å®Œæ•´çš„ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆã€‚

---

# Auto è¯­è¨€æ ¸å¿ƒæ¶æ„ï¼šç»Ÿä¸€è¿è¡Œæ—¶ä¸ç¯å¢ƒæ³¨å…¥ç³»ç»Ÿ

## 1. ç³»ç»Ÿæ¦‚è§ˆ (System Overview)

æˆ‘ä»¬å°†æ•´ä¸ªç¨‹åºçš„å¯åŠ¨ä¸ä¸Šä¸‹æ–‡æ„å»ºè¿‡ç¨‹åˆ’åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š

1. **æ³¨å…¥é˜¶æ®µ (Injection Phase)**ï¼šç¼–è¯‘å™¨æ ¹æ® Target å’Œ Root Configï¼Œåˆæˆå‡ºå½“å‰çš„ **Environment**ã€‚
2. **é¢„å¤‡é˜¶æ®µ (Prelude Phase)**ï¼šç¼–è¯‘å™¨éšå¼å¯¼å…¥ `std.prelude`ã€‚è¿™ä¸ª Prelude ä¸æ˜¯é™æ€çš„ï¼Œå®ƒæ ¹æ® Environment åŠ¨æ€å¯¼å‡º `List`ã€`String`ã€`print` ä»¥åŠå†…å­˜åˆ†é…ç­–ç•¥ã€‚
3. **å¯åŠ¨é˜¶æ®µ (Startup Phase)**ï¼šç”ŸæˆçœŸæ­£çš„å…¥å£ç‚¹ï¼ˆ`_start` æˆ– `main`ï¼‰ï¼Œæ‰§è¡Œç¯å¢ƒåˆå§‹åŒ–ï¼ˆå¦‚å †åˆå§‹åŒ–ï¼‰ï¼Œæœ€åç§»äº¤æ§åˆ¶æƒç»™ç”¨æˆ·çš„ `main`ã€‚

---

## 2. è¯¦ç»†è®¾è®¡ï¼šä¸‰ä½ä¸€ä½“æœºåˆ¶

### 2.1 æ³¨å…¥é˜¶æ®µï¼šæ„å»º `std.env`

è¿™æ˜¯ç¼–è¯‘å™¨çš„ç¬¬ä¸€æ­¥å·¥ä½œã€‚ç¼–è¯‘å™¨åˆ†æ CLI å‚æ•°å’Œç”¨æˆ·æ ¹æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿæ¨¡å— `std.env`ã€‚

**é€»è¾‘æµï¼š**

1. è¯»å– `-target` (e.g., `cortex-m4` æˆ– `x64-linux`).
2. è§£æå…¥å£æ–‡ä»¶ (`root.at`)ï¼ŒæŸ¥æ‰¾ç‰¹æ®Šçš„ `[config]` å—æˆ–å¸¸é‡ã€‚
3. åˆæˆ `std.env`ã€‚

```auto
// è™šæ‹Ÿç”Ÿæˆçš„ std.env æ¨¡å—
module std.env {
    // 1. å¹³å°ç‰¹å¾
    const TARGET_ARCH = "armv7e-m"
    const TARGET_OS   = "none" // MCU
    
    // 2. å†…å­˜ç­–ç•¥ (ç”± Target + Root Config å†³å®š)
    // å¦‚æœæ˜¯ MCUï¼Œé»˜è®¤ Fixedï¼›å¦‚æœæ˜¯ PCï¼Œé»˜è®¤ Heap
    type DefaultListStorage<T> = std.storage.Fixed<T, 64>
    
    // 3. é”™è¯¯å¤„ç†ç­–ç•¥
    // MCU: æ­»å¾ªç¯; PC: æ‰“å°å †æ ˆå¹¶é€€å‡º
    const PANIC_STRATEGY = "loop" 
}

```

### 2.2 é¢„å¤‡é˜¶æ®µï¼šåŠ¨æ€ Prelude

Auto ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åœ¨æ¯ä¸ªç”¨æˆ·æ–‡ä»¶çš„å¤´éƒ¨æ’å…¥ `import std.prelude`ã€‚ä½†è¿™ä¸ª Prelude æ˜¯æ™ºèƒ½çš„ï¼Œå®ƒå……å½“äº† **â€œç¯å¢ƒé€‚é…å™¨â€**ã€‚

**std/prelude.at (ä¼ªä»£ç )**

```auto
import std.env
import std.io
import std.container

// --- 1. å¯¼å‡ºåŸºç¡€ç±»å‹ ---
pub type int = i32
pub type bool = u1

// --- 2. å¯¼å‡ºé€‚é…åçš„å®¹å™¨ ---
// è¿™é‡Œçš„ List å·²ç»æºå¸¦äº†ç¯å¢ƒæ³¨å…¥çš„ Storage ç­–ç•¥
pub type List<T> = std.container.List<T, std.env.DefaultListStorage<T>>

// è¿™é‡Œçš„ String æ ¹æ®ç¯å¢ƒå¯èƒ½æ˜¯ HeapString æˆ– StackString
pub type String = if std.env.TARGET_OS == "none" 
                  then std.container.FixedString<256> 
                  else std.container.HeapString

// --- 3. å¯¼å‡ºé€‚é…åçš„ IO ---
// MCU ä¸‹ print å¯èƒ½è¾“å‡ºåˆ° UARTï¼ŒPC ä¸‹è¾“å‡ºåˆ° Stdout
pub const print = std.io.get_printer(std.env.TARGET_OS)

// --- 4. è¯­æ³•ç³–å¼€å…³ ---
// å¦‚æœæ˜¯æç®€ MCU ç¯å¢ƒï¼Œå¯èƒ½ç¦ç”¨å¤æ‚çš„ Runtime Type Information (RTTI)
# if std.env.TARGET_OS == "none" {
#    disable_feature(RTTI)
# }

```

**ç”¨æˆ·è§†è§’ï¼š**
ç”¨æˆ·ä»€ä¹ˆéƒ½ä¸ç”¨é…ç½®ï¼Œç›´æ¥å†™ï¼š

```auto
fn main() {
    let list List<i32> // è‡ªåŠ¨è·å¾—æœ€ä½³å®ç°
    list.push(1)
    print("Ready")     // è‡ªåŠ¨è·¯ç”±åˆ°ä¸²å£æˆ–æ§åˆ¶å°
}

```

### 2.3 å¯åŠ¨é˜¶æ®µï¼šRuntime Startup (Bootstrap)

è¿™æ˜¯ç”Ÿæˆçš„ C ä»£ç å±‚é¢çš„é­”æ³•ã€‚Auto ç¼–è¯‘å™¨ä¸ä¼šç›´æ¥æŠŠç”¨æˆ·çš„ `main` ç¿»è¯‘æˆ C çš„ `main`ï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä¸ª **å¼•å¯¼ç¨‹åº (Bootstrap)**ã€‚

#### A. PC å¹³å°å¼•å¯¼ (`entry_pc.c`)

PC ç¯å¢ƒä¸‹ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£å †çš„åˆå§‹åŒ–ï¼Œå¼•å¯¼å¾ˆç®€å•ã€‚

```c
// Auto ç”Ÿæˆçš„ C ä»£ç 
int main(int argc, char** argv) {
    // 1. åˆå§‹åŒ– GC (å¦‚æœ Auto æœªæ¥æ”¯æŒ) æˆ– å…¨å±€åˆ†é…å™¨
    std_heap_init();
    
    // 2. å¤„ç†å‘½ä»¤è¡Œå‚æ•°
    auto_args_init(argc, argv);
    
    // 3. è°ƒç”¨ç”¨æˆ·çš„ main
    user_main();
    
    // 4. æ¸…ç†èµ„æº
    return 0;
}

```

#### B. MCU å¹³å°å¼•å¯¼ (`entry_mcu.c`)

MCU ç¯å¢ƒä¸‹ï¼ŒAuto æ¥ç®¡ä¸€åˆ‡ã€‚å‡è®¾ç”¨æˆ·æ˜¾å¼é…ç½®äº† `Heap` ç­–ç•¥ï¼ŒStartup ä»£ç å¿…é¡»è´Ÿè´£åˆå§‹åŒ–ä¸€å—é™æ€å†…å­˜ä½œä¸ºå †ã€‚

```c
// Auto ç”Ÿæˆçš„ C ä»£ç 

// å®šä¹‰å…¨å±€å †ç©ºé—´ (å¦‚æœ env é…ç½®äº†éœ€è¦ Heap)
#ifdef ENV_USE_HEAP
static uint8_t __heap_space[ENV_HEAP_SIZE];
#endif

// å¤ä½å¤„ç†å‡½æ•° (ç”±å¯åŠ¨æ–‡ä»¶è°ƒç”¨)
void Auto_Reset_Handler() {
    // 1. ç¡¬ä»¶åˆå§‹åŒ– (æ—¶é’Ÿã€çœ‹é—¨ç‹—ç­‰ï¼Œç”± ext hooks æä¾›)
    SystemInit();
    
    // 2. å †åˆ†é…å™¨åˆå§‹åŒ– (å°† __heap_space æŒ‚è½½ç»™ malloc)
    #ifdef ENV_USE_HEAP
    std_allocator_init(__heap_space, ENV_HEAP_SIZE);
    #endif
    
    // 3. å…¨å±€å˜é‡/é™æ€æ„é€ å‡½æ•°åˆå§‹åŒ–
    __libc_init_array();
    
    // 4. è·³è½¬åˆ°ç”¨æˆ·é€»è¾‘
    user_main();
    
    // 5. å¦‚æœ main è¿”å›äº†ï¼Œè¿›å…¥æ­»å¾ªç¯ (Panic ç­–ç•¥)
    while(1);
}

```

---

## 3. åœºæ™¯æ¼”ç»ƒï¼šä» Config åˆ° Startup

è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸€æ•´å¥—æœºåˆ¶å¦‚ä½•å¤„ç†ä¸¤ä¸ªæç«¯åœºæ™¯ã€‚

### åœºæ™¯ä¸€ï¼šæç®€ MCU ä¼ æ„Ÿå™¨èŠ‚ç‚¹

* **Root Config**: æ— ï¼ˆå…¨é»˜è®¤ï¼‰ã€‚
* **Target**: `cortex-m0`ã€‚

1. **Injection**: `std.env` åˆ¤å®šä¸º MCUï¼Œè®¾å®š `DefaultListStorage = Fixed<64>`, `String = FixedString<64>`ã€‚éœ€ä¸éœ€è¦ Heapï¼Ÿå¦ã€‚
2. **Prelude**: å¯¼å‡ºé™æ€çš„ `List` å’Œ `String`ã€‚`print` æ˜ å°„ä¸ºç©ºæ“ä½œæˆ–åŠä¸»æœºæ¨¡å¼ã€‚
3. **Startup**: ç”Ÿæˆ `entry_mcu.c`ã€‚æ£€æµ‹åˆ°ä¸éœ€è¦ Heapï¼Œ**ä¸ç”Ÿæˆ** `__heap_space` æ•°ç»„ï¼Œ**ä¸è°ƒç”¨** `allocator_init`ã€‚ç”Ÿæˆæè‡´ç²¾ç®€çš„äºŒè¿›åˆ¶ã€‚

### åœºæ™¯äºŒï¼šMCU é«˜çº§åº”ç”¨ (ä½¿ç”¨ Arena)

* **Root Config**:
```auto
// main.at
[config]
const HeapSize = 4096      // æˆ‘æƒ³è¦ 4K çš„å †
const MainStorage = Heap   // é»˜è®¤ List ä½¿ç”¨å †

```


* **Target**: `cortex-m4`ã€‚

1. **Injection**: `std.env` è¯»å–é…ç½®ã€‚è®¾å®š `DefaultListStorage = Heap`ã€‚æ ‡è®° `ENV_USE_HEAP = true`ï¼Œ`ENV_HEAP_SIZE = 4096`ã€‚
2. **Prelude**: å¯¼å‡ºçš„ `List` é»˜è®¤ä¸º `List<T, Heap>`ã€‚
3. **Startup**: ç”Ÿæˆ `entry_mcu.c`ã€‚ç¼–è¯‘å™¨åœ¨ `.bss` æ®µé¢„ç•™ 4096 å­—èŠ‚æ•°ç»„ã€‚`Auto_Reset_Handler` å¯åŠ¨æ—¶ï¼Œè°ƒç”¨ `std_allocator_init` åˆå§‹åŒ–è¿™å—å†…å­˜ã€‚ä¹‹åï¼Œç”¨æˆ·ä»£ç é‡Œçš„ `list.push` å°±èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚

---

## 4. å®æ–½è®¡åˆ’ (Execution Plan)

### é˜¶æ®µ 1ï¼šPrelude æ¶æ„æ­å»º

* åˆ›å»ºä¸€ä¸ª `std/prelude.at` æ–‡ä»¶ã€‚
* ä¿®æ”¹ç¼–è¯‘å™¨ï¼Œä½¿å…¶åœ¨è§£æä»»ä½•æ–‡ä»¶å‰ï¼Œå…ˆè§£æ `std/prelude.at` å¹¶å°†ç¬¦å·æ³¨å…¥å½“å‰ä½œç”¨åŸŸã€‚
* å®ç°åŸºæœ¬çš„ `if/else` ç¼–è¯‘æœŸé€»è¾‘ï¼Œç”¨äºåœ¨ Prelude ä¸­æ ¹æ® Target åˆ‡æ¢å¯¼å‡ºç±»å‹ã€‚

### é˜¶æ®µ 2ï¼šEnvironment æ³¨å…¥ç¼–è¯‘å™¨

* åœ¨ç¼–è¯‘å™¨ä¸­å¢åŠ  `--root <file>` å‚æ•°ã€‚
* å®ç° AST æ‰«æå™¨ï¼Œç”¨äºæå– Root æ–‡ä»¶ä¸­çš„ `[config]` å¸¸é‡ã€‚
* å®ç° `std.env` è™šæ‹Ÿæ¨¡å—ç”Ÿæˆå™¨ã€‚

### é˜¶æ®µ 3ï¼šStartup ä»£ç ç”Ÿæˆå™¨ (Codegen)

* **A2C æ¨¡å—æ›´æ–°**ï¼šä¸å†ç›´æ¥ç”Ÿæˆ `main()`ã€‚
* **Template ç³»ç»Ÿ**ï¼šåˆ›å»º `entry_pc.c.tpl` å’Œ `entry_mcu.c.tpl` æ¨¡æ¿ã€‚
* **Linker é€»è¾‘**ï¼šæ ¹æ®æ˜¯å¦ä½¿ç”¨äº† Heap ç­–ç•¥ï¼Œå†³å®šæ˜¯å¦åœ¨ç”Ÿæˆçš„ C ä»£ç ä¸­åŒ…å«ç®€å•çš„ malloc å®ç°ï¼ˆå¦‚ `tiny_alloc`ï¼‰ã€‚

---

## 5. æ€»ç»“

å°† **List æ³›å‹ç­–ç•¥** ä¸ **Prelude** åŠ **Startup** ç»“åˆåï¼ŒAuto è¯­è¨€è·å¾—äº†ä¸€ç§ **"ç”Ÿç‰©èˆ¬çš„é€‚åº”æ€§"**ï¼š

* å®ƒæ ¹æ®ç¯å¢ƒï¼ˆEnvï¼‰è°ƒæ•´è‡ªå·±çš„å™¨å®˜ï¼ˆList/Stringï¼‰ã€‚
* å®ƒæ ¹æ®åŸºå› ï¼ˆConfigï¼‰è°ƒæ•´è‡ªå·±çš„ç”Ÿé•¿æ–¹å¼ï¼ˆStartupï¼‰ã€‚
* å®ƒç»™ç»†èƒï¼ˆç”¨æˆ·ä»£ç ï¼‰æä¾›äº†ä¸€ä¸ªçœ‹ä¼¼ä¸å˜ä½†å®åˆ™é«˜åº¦é€‚é…çš„ç”Ÿå­˜ç¯å¢ƒï¼ˆPreludeï¼‰ã€‚

è¿™å°±å®ç°äº†ä½ æƒ³è¦çš„ï¼š**ä¸€å¥—ä»£ç ï¼Œä¸€ç§æ¥å£ï¼Œæ¶µç›–ä» 8-bit MCU åˆ° 64-bit Server çš„å…¨åœºæ™¯ã€‚**

---

## 6. å®æ–½çŠ¶æ€ (Implementation Status)

**æ–‡æ¡£ç±»å‹**: æ¶æ„è®¾è®¡æ„¿æ™¯

**ç›¸å…³å®ç°**: [Plan 055 - Storage ç¯å¢ƒæ³¨å…¥å®ç°](./055-storage-injection.md)

### âœ… å·²å®ç° (2025-01-23)

ä»¥ä¸‹åŠŸèƒ½å·²åœ¨ Plan 055 ä¸­å®ç°ï¼š

**æ ¸å¿ƒåŸºç¡€è®¾æ–½**:
- âœ… **Storage ç±»å‹ç³»ç»Ÿ**: Fixedï¼ˆé™æ€ï¼‰å’Œ Dynamicï¼ˆå †ï¼‰å­˜å‚¨ç­–ç•¥æ ‡è®°ç±»å‹
- âœ… **ç›®æ ‡æ£€æµ‹ç³»ç»Ÿ**: Target æšä¸¾ï¼ˆMcu/Pcï¼‰å’Œè‡ªåŠ¨æ£€æµ‹é€»è¾‘
- âœ… **ç¯å¢ƒæ³¨å…¥æœºåˆ¶**: ç¼–è¯‘å™¨å¯åŠ¨æ—¶æ³¨å…¥ `TARGET`ã€`DEFAULT_STORAGE`ã€`HAS_HEAP` ç¯å¢ƒå˜é‡
- âœ… **List.capacity() æ–¹æ³•**: è¿”å›ç›®æ ‡ä¾èµ–çš„å®¹é‡ä¿¡æ¯ï¼ˆMCU: 64, PC: INT_MAXï¼‰
- âœ… **CLI --target æ ‡å¿—**: å…è®¸ç”¨æˆ·è¦†ç›–ç¼–è¯‘ç›®æ ‡ï¼ˆmcu/pc/autoï¼‰
- âœ… **Prelude é›†æˆ**: æ›´æ–° `std/prelude.at` æ–‡æ¡£ä»¥åæ˜  List å¯ç”¨æ€§

**æµ‹è¯•è¦†ç›–**:
- âœ… 23 ä¸ªå•å…ƒæµ‹è¯•ï¼ˆç±»å‹ç³»ç»Ÿã€ç›®æ ‡æ£€æµ‹ã€ç¯å¢ƒæ³¨å…¥ï¼‰
- âœ… 3 ä¸ªé›†æˆæµ‹è¯•ï¼ˆç«¯åˆ°ç«¯ç¯å¢ƒæ³¨å…¥æµç¨‹ï¼‰
- âœ… a2c è½¬è¯‘æµ‹è¯•ï¼ˆStorage ç±»å‹ C ä»£ç ç”Ÿæˆï¼‰

**å®ç°æ–‡ä»¶**:
- `src/target.rs` - ç›®æ ‡æ£€æµ‹ç³»ç»Ÿ
- `src/universe.rs` - ç¯å¢ƒæ³¨å…¥ API
- `src/interp.rs` - å¯åŠ¨æ—¶ç¯å¢ƒæ³¨å…¥
- `src/ast/types.rs` - Storage ç±»å‹æ”¯æŒ
- `src/vm/list.rs` - List.capacity() å®ç°
- `stdlib/auto/storage.at` - Storage æ–‡æ¡£æ¨¡å—
- `stdlib/auto/list.at` - List æ¥å£å®šä¹‰
- `stdlib/auto/prelude.at` - Prelude æ›´æ–°

### ğŸ“‹ å¾…å®ç°

ä»¥ä¸‹åŠŸèƒ½ä¸ºæœ¬æ¶æ„è®¾è®¡çš„æœªæ¥æ–¹å‘ï¼š

**é˜¶æ®µ 1: Prelude æ¶æ„** (Plan 054 é˜¶æ®µ 1)
- â¸ï¸ ç¼–è¯‘æœŸ `if/else` é€»è¾‘ï¼ˆç”¨äº Prelude ä¸­æ¡ä»¶å¯¼å‡ºç±»å‹ï¼‰
- â¸ï¸ `String` ç±»å‹é€‚é…ï¼ˆFixedString vs HeapStringï¼‰
- â¸ï¸ `print` å‡½æ•°è·¯ç”±ï¼ˆUART vs Stdoutï¼‰

**é˜¶æ®µ 2: æ ¹é…ç½®ç³»ç»Ÿ** (Plan 054 é˜¶æ®µ 2)
- â¸ï¸ `[config]` å—è¯­æ³•å’Œè§£æ
- â¸ï¸ Root Config å¸¸é‡æå–å™¨
- â¸ï¸ ç”¨æˆ·çº§å †å¤§å°é…ç½®ï¼ˆ`const HeapSize = 4096`ï¼‰
- â¸ï¸ ç”¨æˆ·çº§å­˜å‚¨ç­–ç•¥é€‰æ‹©ï¼ˆ`const MainStorage = Heap`ï¼‰

**é˜¶æ®µ 3: Startup ä»£ç ç”Ÿæˆ** (Plan 054 é˜¶æ®µ 3)
- â¸ï¸ A2C ä¸å†ç›´æ¥ç”Ÿæˆ `main()`ï¼Œè€Œæ˜¯ç”Ÿæˆ `_start` æˆ–å¼•å¯¼ç¨‹åº
- â¸ï¸ `entry_pc.c.tpl` å’Œ `entry_mcu.c.tpl` æ¨¡æ¿
- â¸ï¸ MCU å †åˆå§‹åŒ–ä»£ç ï¼ˆ`__heap_space` æ•°ç»„ + `std_allocator_init`ï¼‰
- â¸ï¸ é“¾æ¥å™¨é›†æˆï¼ˆæ¡ä»¶åŒ…å« tiny_allocï¼‰

**é«˜çº§åŠŸèƒ½**:
- â¸ï¸ ç¼–è¯‘æœŸç‰¹å¾æ£€æµ‹ï¼ˆ`# if std.env.TARGET_OS == "none"`ï¼‰
- â¸ï¸ RTTI å¼€å…³ï¼ˆ`# disable_feature(RTTI)`ï¼‰
- â¸ï¸ åµŒå¥—æ³›å‹ï¼ˆ`List<T, Storage<E>>`ï¼‰
- â¸ï¸ è‡ªå®šä¹‰ Fixed å®¹é‡ï¼ˆç”¨æˆ·æ˜¾å¼ `List<int, Fixed<128>>`ï¼‰
- â¸ï¸ æ··åˆå­˜å‚¨ï¼ˆFixed è¶…è¿‡å®¹é‡æ—¶åˆ‡æ¢åˆ° Dynamicï¼‰

### ğŸ“Š å®ç°è¿›åº¦

| ç»„ä»¶ | çŠ¶æ€ | å®Œæˆåº¦ |
|------|------|--------|
| Storage ç±»å‹ç³»ç»Ÿ | âœ… å®Œæˆ | 100% |
| ç›®æ ‡æ£€æµ‹ç³»ç»Ÿ | âœ… å®Œæˆ | 100% |
| ç¯å¢ƒæ³¨å…¥æœºåˆ¶ | âœ… å®Œæˆ | 100% |
| List.capacity() | âœ… å®Œæˆ | 100% |
| CLI é›†æˆ | âœ… å®Œæˆ | 100% |
| Prelude æ¶æ„ | ğŸ”„ éƒ¨åˆ†å®Œæˆ | 30% |
| æ ¹é…ç½®ç³»ç»Ÿ | âŒ æœªå¼€å§‹ | 0% |
| Startup ä»£ç ç”Ÿæˆ | âŒ æœªå¼€å§‹ | 0% |

**æ€»ä½“å®Œæˆåº¦**: ~40% (æ ¸å¿ƒåŸºç¡€è®¾æ–½å®Œæˆï¼Œé«˜çº§ç‰¹æ€§å¾…å®ç°)

### ğŸ”— ç›¸å…³æ–‡æ¡£

- **å®ç°ç»†èŠ‚**: [Plan 055 - Storage ç¯å¢ƒæ³¨å…¥å®ç°](./055-storage-injection.md)
- **æµ‹è¯•æŠ¥å‘Š**: `src/tests/storage_tests.rs`, `src/tests/storage_integration_tests.rs`
- **æ ‡å‡†åº“**: `stdlib/auto/storage.at`, `stdlib/auto/list.at`, `stdlib/auto/prelude.at`

### ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

1. **çŸ­æœŸ** (1-2 å‘¨):
   - å®ç° C transpiler ç›®æ ‡ç‰¹å®šä»£ç ç”Ÿæˆï¼ˆMCU é™æ€æ•°ç»„ vs PC åŠ¨æ€åˆ†é…ï¼‰
   - æ·»åŠ  List.capacity() å•å…ƒæµ‹è¯•ï¼ˆéªŒè¯è¿”å›å€¼å‡†ç¡®æ€§ï¼‰
   - ä¼˜åŒ–ç¯å¢ƒå˜é‡è®¿é—®æ€§èƒ½ï¼ˆç¼“å­˜æœºåˆ¶ï¼‰

2. **ä¸­æœŸ** (1-2 æœˆ):
   - è®¾è®¡å¹¶å®ç° `[config]` å—è¯­æ³•
   - å®ç°ç¼–è¯‘æœŸ `if/else` é€»è¾‘
   - åˆ›å»º Startup ä»£ç ç”Ÿæˆå™¨

3. **é•¿æœŸ** (3-6 æœˆ):
   - String ç±»å‹é€‚é…ï¼ˆFixedString vs HeapStringï¼‰
   - RTTI ç‰¹æ€§å¼€å…³ç³»ç»Ÿ
   - åµŒå¥—æ³›å‹æ”¯æŒ

---

**æœ€åæ›´æ–°**: 2025-01-23
**æ›´æ–°è€…**: Claude Code
**çŠ¶æ€**: æ ¸å¿ƒåŠŸèƒ½å®Œæˆï¼Œé«˜çº§ç‰¹æ€§è§„åˆ’ä¸­